<!DOCTYPE html>
<html>
    <head>
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <title>How does the Gini coefficient relate to the fifth quintile?</title>
        <link href="style.css" type="text/css" rel="stylesheet">
    </head>

    <body>
        
        <h1>How does the Gini coefficient relate to the fifth quintile?</h1>
        
        <p> 
        The gini coefficient is a is a measure of statistical dispersion intended to represent the income or wealth distribution of a nation's residents, and is the most commonly used measure of inequality. 
        The value of q5 (the fifth quintile) represents the share of total income going to the wealthiest 25% of the population. For example, if q5 is 50%, that means that 50% of total income is earned by the top 1/5th wealthiest households.
        </p>
        
        <div id='target'></div>
        
        <script>
            var graph = d3.select('#target')
                .append('svg')
                .attr('width', window.innerWidth)
                .attr('height', 2700);
            
            d3.csv('wiid_dummy.csv', function(error, data) {
                if (error) throw error;
                
                svg(data);
            });
            
            function svg(data) {
                var tmp = [];
                for(var i in data) {
                    tmp.push(data[i].q5);
                }
                var max = d3.max(tmp);
                console.log(max);
                
                var x = d3.scaleLinear()
                    .domain([0, max])
                    .range([0, window.innerHeight]);
                    
                var y = d3.scaleLinear()
                    .domain([0, data.length])
                    .range([0, window.innerWidth]);
                    
                graph.append('g')
                    .attr('id', 'group');
                    
                var group = graph.select('#group')
                    .selectAll('g')
                    .data(data)
                    .enter()
                    .append('g')
                    .attr('y', function(d, i) { return y(i); })
                    .attr('transform', function(d, i) {
            			return 'translate(0,' + (y(i)*20) + ')';
            		});
            		
            	group.append('rect')
            	    .attr('class', 'bar')
            	    //.attr('x', function(d, i) { return window.innerWidth-x(d.q5); })
            	    .attr('x', 0)
            	    .attr('y', function(d,i) { return (50 + (i*20)); })
            	    .attr('width', function(d, i) { return x(d.q5); })
            	    .attr('height', function(d, i) { return y(10) ; });
            	    
            	group.append('text')
            	    .text(function(d) { return (d.country) + '  | Gini: ' + (d.avggini) + '  | q5: ' + (d.q5); })
                    .attr('transform', function(d, i) { return 'translate(0, '+ (50 + (i*20)) + ')'});
                    
            }

        </script>
    </body>
</html>